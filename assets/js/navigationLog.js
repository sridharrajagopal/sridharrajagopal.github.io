function printPortion(e){var t=document.getElementById(e),l=window.open("","","width=800,height=600");l.document.write("<html><head><title>Print</title>"),l.document.write("</head><body>"),l.document.write(t.innerHTML),l.document.write("</body></html>"),l.document.close(),l.print(),l.close()}function createCellWithTextArea(e,t){var l=e.insertCell();l.rowSpan=2;let a=document.createElement("textarea");a.name=t,a.rows=2,l.appendChild(a)}function createCellWithInput(e,t,l=1,a=1,u=!1,n=!1){var o=e.insertCell();o.colSpan=l,o.rowSpan=a;var r=document.createElement("input");r.name=t,r.type="text",r.readOnly=u,r.disabled=n,o.appendChild(r)}function createCellWithFillEnroute(e){e.insertCell().classList.add("fillEnroute")}function createCellWithHiddenInput(e,t,l=1,a=1){var u=e.insertCell();u.colSpan=l,u.rowSpan=a;var n=document.createElement("input");n.name=t,n.type="hidden",u.appendChild(n)}function createCounter(){let e=3;return function(){return e++}}function insertRow(){var e=document.getElementById("NavLog"),t=counter(),l=e.getElementsByTagName("tbody")[0].insertRow();createCellWithTextArea(l,"A"+t),createCellWithInput(l,"B"+t),createCellWithTextArea(l,"C"+t),createCellWithInput(l,"D"+t),createCellWithTextArea(l,"E"+t),createCellWithTextArea(l,"F"+t),createCellWithInput(l,"G"+t),createCellWithInput(l,"H"+t),createCellWithInput(l,"I"+t,1,2),createCellWithInput(l,"J"+t),createCellWithInput(l,"K"+t,1,1,!0,!0),createCellWithInput(l,"L"+t,1,1,!0,!0),createCellWithInput(l,"M"+t,1,2,!0,!0),createCellWithInput(l,"N"+t),createCellWithInput(l,"O"+t,1,1,!0,!0),createCellWithInput(l,"P"+t,1,1,!0,!0),createCellWithFillEnroute(l),createCellWithInput(l,"R"+t,1,2),createCellWithInput(l,"S"+t,1,1,!0,!0),createCellWithHiddenInput(l,"T"+t),t=counter(),createCellWithInput(l=e.getElementsByTagName("tbody")[0].insertRow(),"B"+t),createCellWithInput(l,"D"+t),createCellWithInput(l,"G"+t+"H"+t,2),createCellWithInput(l,"J"+t,1,1,!0,!0),createCellWithInput(l,"K"+t),createCellWithInput(l,"L"+t),createCellWithInput(l,"N"+t,1,1,!0,!0),createCellWithFillEnroute(l),createCellWithFillEnroute(l),createCellWithFillEnroute(l),createCellWithInput(l,"S"+t,1,1,!0,!0),l.insertCell()}function deleteRow(){var e=document.getElementById("NavLog").getElementsByTagName("tbody")[0];let t=e.rows.length;t>2&&(e.deleteRow(t-1),e.deleteRow(t-2))}function ComputeTotal(e,t,l){var a;0==e.value&&(e.value=0),0==t.value&&(t.value=0),(a=Math.round(e.value)+Math.round(t.value))<0&&(a=360+a),l.value=a%360}function ComputeColSum(e){var t=0;for(i=0;i<e.length-1;i++)0==e[i].value&&(e[i].value=0),t+=parseFloat(e[i].value);e[e.length-1].value=t.toFixed(2)}function ComputeColRem(e,t){var l=0;for(l=0==e.value?0:parseFloat(e.value),i=0;i<t.length;i+=2){let e=l-parseFloat(t[i].value);l=e,t[i+1].value=e.toFixed(2)}}function ComputeThetaW(e,t,l){var a;0==e.value&&(e.value=0),0==t.value&&(t.value=0),(a=(Math.round(e.value)+180)%360)>=Math.round(t.value)?l.value=Math.abs(Math.round(t.value)-a)%360:l.value=360-Math.abs(Math.round(t.value)-a)%360}function ComputeWindCorrectionAngle(e,t,l,a){var u;0==e.value&&(e.value=0),0==t.value&&(t.value=0),0==l.value&&(l.value=0),u=0==t.value?0:180*Math.asin(Math.round(e.value)/Math.round(t.value)*Math.sin(l.value*Math.PI/180))/Math.PI,a.value=-Math.round(u)}function ComputeGroundSpeed(e,t,l,a,u){0==e.value&&(e.value=0),0==t.value&&(t.value=0),0==l.value&&(l.value=0),0==a.value&&(a.value=0),u.value=Math.round(Math.round(t.value)*Math.cos(Math.round(l.value)*Math.PI/180)+Math.round(e.value)*Math.cos(Math.round(a.value)*Math.PI/180))}function ComputeLegTime(e,t,l){0==e.value&&(e.value=0),0==t.value&&(t.value=0),0==e.value?l.value=0:l.value=Math.round(Math.round(e.value)/Math.round(t.value)*60)}function ComputeFuelAmt(e,t,l){0==e.value&&(e.value=0),0==t.value&&(t.value=0),0==t.value?l.value=0:l.value=(Math.round(e.value)/60*parseFloat(t.value)).toFixed(2)}function ComputeRow(e,t,l,a,u,n,o,r,i,h,m,c,p,v,C,d){ComputeThetaW(e,a,d),ComputeWindCorrectionAngle(t,l,d,u),ComputeGroundSpeed(t,l,u,d,c),ComputeLegTime(m,c,p),ComputeFuelAmt(p,v,C),ComputeTotal(a,u,n),ComputeTotal(n,o,r),ComputeTotal(r,i,h)}function ComputeResults(e){const t=[],l=[],a=[],u=[],n=[];for(var o=3;o<e.length-7;o+=27)ComputeRow(e.elements[o+6],e.elements[o+7],e.elements[o+8],e.elements[o+9],e.elements[o+22],e.elements[o+10],e.elements[o+23],e.elements[o+11],e.elements[o+24],e.elements[o+12],e.elements[o+13],e.elements[o+14],e.elements[o+15],e.elements[o+16],e.elements[o+17],e.elements[o+18]),t.push(e.elements[o+13]),l.push(e.elements[o+15]),a.push(e.elements[o+17]),n.push(e.elements[o+13]),n.push(e.elements[o+25]),u.push(e.elements[o+17]),u.push(e.elements[o+26]);t.push(e.NTOT),l.push(e.PTOT),a.push(e.STOT),ComputeColSum(t),ComputeColSum(l),ComputeColSum(a),ComputeColRem(e.FUELTOT,u),ComputeColRem(e.NTOT,n)}const counter=createCounter();